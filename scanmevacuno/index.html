
<!DOCTYPE html>
<html ng-app="mevacunoApp">
<head>
    <title>Scan</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon">
    <link rel="icon" href="favicon.png" type="image/x-icon">
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" />
    <script src="qr-scanner.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.2/angular.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.2/angular.min.js.map"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/2.5.6/ui-bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/2.5.6/ui-bootstrap-tpls.min.js"></script>
    <script>
        angular.module('mevacunoApp', ['ui.bootstrap']);
        
        angular.module('mevacunoApp').controller('webcamModalController', ['$scope', '$uibModalInstance', function ($scope, $uibModalInstance) {
            
            console.log("Waiting 300ms...")
            
            setTimeout(function () {
                
                console.log("Initializing webcam");
                const qrScanner = new QrScanner(document.getElementById("webcam"), function(result) {
                    
                    console.log('decoded qr code:', result);
                    qrScanner.stop();
                    $uibModalInstance.dismiss('cancel');    
                    window.location.replace("index2.html");
                });
                
                qrScanner.start();
                
            }, 300);

            $scope.cancel = function () {
                $uibModalInstance.dismiss('cancel');
            };
        }]);
        
        angular.module('mevacunoApp').controller('bodyController', ['$scope', '$uibModal', function($scope, $uibModal) {
        
            $scope.openWebcamModal = function () {
            
                var modalInstance = $uibModal.open({
                    templateUrl: 'webcamModal.html',
                    controller: 'webcamModalController',
                    scope: $scope,
                    backdrop: false
                });

                modalInstance.result.then(function (result) {
                }, null);
            };
        }]);
        

    </script>
</head>

<style>
@font-face {
  font-family:"Roboto";
  src: url("Roboto-Regular.ttf") format("truetype");
}

body {
    font-family: Roboto
}
</style>

<body style="background-image: url('background.jpg'); background-repeat: no-repeat; background-size: 200%; background-position: -200px 100px;" ng-controller="bodyController">

    <div style="height: 70px; width: 100%; background-color: #197a86; padding-left: 25px; padding-top: 10px; border-bottom: 3px solid #b3b3b3;">
        <strong style="color: white; margin: 0px; font-size: 18px;">Escáner</strong><br>
        <span style="color: #e7e7e7; font-size: 14px;">scanmevacuno.gob.cl</span>
        <span style="font-size: 14px; color: #e7e7e7; float: right">V 2.2.5</span>
    </div>
    
    <div style="width: 100%; background-color: #d4faff; text-align: center; padding: 5px">
        <p style="font-size: 12px; padding: 3px">Para tener acceso de lectura a la información íntegra del pase a escanear, inicie sesión con su Clave Única</p>
    </div>

    <div style="cursor: pointer; width: 170px;background-color: #0f69c4;border-radius: 5px;text-align: center;margin: auto;margin-top: 30px;padding-top: 5px;">
        <img src="iniciar-sesion.png" alt="">
    </div>
    
    <p style="font-size: 13px; text-align: center; margin-top: 30px">Puede escanear sin autenticarse, pero solo accederá a información parcial</p>
    
    <div ng-click="openWebcamModal()" style="cursor: pointer; padding-top: 10px; padding-bottom: 10px; margin: auto; border-radius: 5px;border: 2px solid #9c27b0; width: 95%; text-align: center; margin-top: 30px;">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="color: #9c27b0; height: 16px; padding-right: 5px;"><path class="" fill="currentColor" d="M0 224h192V32H0v192zM64 96h64v64H64V96zm192-64v192h192V32H256zm128 128h-64V96h64v64zM0 480h192V288H0v192zm64-128h64v64H64v-64zm352-64h32v128h-96v-32h-32v96h-64V288h96v32h64v-32zm0 160h32v32h-32v-32zm-64 0h32v32h-32v-32z"></path></svg>
        <strong style="font-size: 14px;color: #9c27b0;">ESCANEAR PASE</strong>
    </div>
    
    <div style="background-color: white;border-top: 3px solid #bdbdbd;bottom: 0;position: fixed;width: 100%;text-align: center;">
        <img src="footer.png" alt="" style="width: 300px;">
    </div>
    
    <!-- Modal -->
    <script type="text/ng-template" id="webcamModal.html">
        <div class="modal-header" style="background-color: #197a86">
            <h3 class="modal-title">
                <span style="color: white">Encuadre Código QR</span>
                <a href style="color: white; font-size: 15px; float: right" ng-click="cancel()">Cerrar</a>
            </h3>
        </div>
        <div class="modal-body">
            <!--<div style="width: 500px" id="reader"></div>-->
            <video id="webcam" style="width: 100%"></video>
        </div>
    </script>

</body>

<!--<body style="background-color: #f6f7f9; margin: 0px">

    <div style="height: 139px; width: 100%; background-color: #2196f3">
        <p style="color: white; margin: 0px; padding: 15px; font-size: 15px;">Pase de movilidad:</p>
    </div>

    <div style="position: absolute; top: 35px; left: 50%; transform: translate(-50%, 0);">
        <h1 style="text-align: center; color: white; margin-bottom: 10px">HABILITADO</h1>
	
        <div style="padding-top: 10px; margin: auto; border-radius: 5px; border: 1px solid #cccccc; width: 340px; text-align: center; background-color: white">
            <span style="font-size: 24px"><strong>RUN 16.936.176-2</strong></span><br />
            <span style="font-size: 18px"><strong>VICENCIO LOYOLA</strong></span><br />
            <span style="font-size: 18px; ">GERMAN IGNACIO</span>
            <div style="border-bottom: 1px solid gray; margin-top: 15px; text-align: center; border-radius: 5px; padding: 4px; background-color: #2196f3">
                <img src="thumbup.png" />
            </div>
        </div>
        
        <div style="margin: auto; margin-top: 25px; font-size: 12px; width: 350px; text-align: center; background-color: #fff0a0">
            <p style="padding: 18px">El <strong>Pase de movilidad HABILITADO</strong> acredita que la persona en consulta ya ha cumplido el período de 14 días luego de completar su esquema de vacunación contra el COVID-19 y que, además, no se encuentra con indicación de aislamiento obligatorio determinado por la autoridad sanitaria según los registros oficiales actuales.</p>
        </div>
        
        <div style="text-align: center; margin-top: 25px">
            <img src="gob.jpg" />
            <img src="minsal.jpg" style="margin-left: 60px" />
        </div>

    </div>

</body>-->
</html>
